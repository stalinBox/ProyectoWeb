<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:rich="http://richfaces.org/rich">

<h:head></h:head>
<body>
	<ui:composition template="/WEB-INF/templates/basicTemplate.html">
		<f:loadBundle basename="messages.properties" var="msg" />
		<ui:define name="content">
			<p:ajaxStatus onstart="PF('statusDialog').show()"
				onsuccess="PF('statusDialog').hide()" />

			<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
				closable="false" resizable="false" showHeader="false">
				<p:graphicImage value="/images/loader.gif" />
			</p:dialog>
			<p:growl id="msgs" showDetail="true" />

			<h:form id="idFrmParametrizacion">
				<p:panel id="idPanel">
					<p:messages autoUpdate="true" />
					<f:facet name="header">PARAMETRIZACION</f:facet>
					<h:panelGrid id="idProc" columns="2">

						<h:outputLabel value="Proceso:" />
						<p:selectOneMenu id="idCboProPadre"
							value="#{paramBean.selectedParametrizacion.proceso.proCodigo}"
							style="width:150px" required="true">

							<p:ajax listener="#{paramBean.onChangeProcesos(actionEvent)}"
								update="idStdCon,idStdAut" />
							<f:selectItem itemLabel="- Seleccione -" itemValue=""
								noSelectionOption="true" />
							<f:selectItems value="#{paramBean.selectedItemsProceso}" />
						</p:selectOneMenu>

						<h:outputLabel value="Responsable:" />
						<p:selectOneMenu id="idResponsable"
							value="#{paramBean.selectedParametrizacion.usuario.userId}"
							required="true" style="width:150px">
							<f:selectItem itemLabel="- Seleccione -" noSelectionOption="true"
								itemValue="0" />
							<f:selectItems
								value="#{ordenProduccionBean.selectedItemsUsuarios}" />
						</p:selectOneMenu>

						<h:outputLabel for="idStdCon" value="Estandar Conv:" />
						<h:inputText id="idStdCon" value="#{paramBean.stdConv}"
							disabled="true" required="true" />

						<h:outputLabel for="idStdAut" value="Estandar Aut:" />
						<h:inputText id="idStdAut" value="#{paramBean.stdAut}"
							disabled="true" required="true" />

						<h:outputLabel for="idTotalOrden" value="Total Orden:" />
						<h:inputText id="idTotalOrden" value="#{paramBean.totOrden}"
							disabled="true" required="true" />

						<f:facet name="footer">
							<p:commandButton id="btnAgregarDetalle" value="Agregar"
								update=":formDataTable, :idFrmParametrizacion"
								actionListener="#{paramBean.btnCreateParametrizacion(actionEvent)}" />

							<p:commandButton id="btnNext" value="Conf. Lineas"
								actionListener="#{paramBean.btnConfLineas()}" process="@this" />
						</f:facet>
					</h:panelGrid>
				</p:panel>
			</h:form>

			<h:form id="formDataTable">
				<p:dataTable id="basicDT" var="p"
					value="#{paramBean.parametrizacion}">

					<f:facet name="header">Detalle Parametrizacion</f:facet>

					<p:column headerText="Proceso">
						<h:outputText value="#{p.proceso.tipoProceso.tprNombre}" />
					</p:column>

					<p:column headerText="Responsable">
						<h:outputText value="#{p.usuario.userName}" />
					</p:column>

					<p:column headerText="StandarConv">
						<h:outputText value="#{p.standconv}" />
					</p:column>

					<p:column headerText="StandarAutomatico">
						<h:outputText value="#{p.standauto}" />
					</p:column>

					<p:column headerText="Eliminar?" style="width:10%">

						<p:commandButton id="btnDelete" update="formDelete"
							oncomplete="PF('dialogParamDelete').show()" icon="ui-icon-close"
							title="Eliminar">
							<f:setPropertyActionListener value="#{p}"
								target="#{paramBean.selectedParametrizacion}" />
						</p:commandButton>
					</p:column>
				</p:dataTable>
			</h:form>


			<h:form id="formDelete">
				<p:confirmDialog id="confirmDialog" message="Esta seguro?"
					showEffect="fade" hideEffect="fade" header="Eliminar Item"
					severity="alert" widgetVar="dialogParamDelete">

					<h:inputHidden
						value="#{paramBean.selectedParametrizacion.paramCodigo}" />

					<p:commandButton id="confirm" value="Si"
						update="formDataTable, msgs,:idFrmParametrizacion"
						icon="ui-icon-check" oncomplete="PF('dialogParamDelete').hide()"
						actionListener="#{paramBean.btnDeleteParametrizacion(actionEvent)}" />

					<p:commandButton id="decline" value="No" icon="ui-icon-close"
						oncomplete="PF('dialogParamDelete').hide()" />
				</p:confirmDialog>
			</h:form>

		</ui:define>
	</ui:composition>
</body>
</html>